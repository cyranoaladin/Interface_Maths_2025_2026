(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function i(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(e){if(e.ep)return;e.ep=!0;const t=i(e);fetch(e.href,t)}})();function a(o){return(location.pathname.startsWith("/content/")?"/content":"")+o}function d(o){try{localStorage.setItem("auth_token",o)}catch{}}function f(){try{localStorage.removeItem("auth_token")}catch{}}document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("login-form");o&&o.addEventListener("submit",async i=>{i.preventDefault();const c=new FormData(o),e=(c.get("email")||c.get("username")||"").toString();try{const t=await fetch("/api/v1/login-form",{method:"POST",body:c});if(!t.ok)throw new Error("Ã‰chec de connexion");const r=await t.json();d(r.access_token),location.href=a("/dashboard.html")}catch{try{const s=await fetch("/api/v1/login/dev",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(s.ok){const l=await s.json();d(l.access_token||""),location.href=a("/dashboard.html");return}}catch{}const r=document.getElementById("login-msg");r&&(r.textContent="Identifiants invalides")}});const n=document.getElementById("logout-btn");n&&n.addEventListener("click",()=>{f(),location.href=a("/index.html")})});
