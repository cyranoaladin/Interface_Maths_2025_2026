<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portail Maths — Accueil</title>
  <style>
    :root{--bg:#0b1020;--card:#151b34;--text:#eef2ff;--muted:#a2b0d6;--link:#7dd3fc;--border:#28314f}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{max-width:1100px;margin:0 auto;padding:22px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:16px}
    nav a{color:var(--link);text-decoration:none;margin:0 8px}
    .btn{background:#151b34;border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:10px}
    .card{background:#151b34;border:1px solid var(--border);border-radius:16px;padding:16px;margin:14px 0}
    h1{margin:8px 0}
    h2{margin:0 0 8px 0}
    h3{margin:10px 0 6px 0;color:var(--muted)}
    ul{margin:0 0 0 18px}
    small{color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Portail Maths — Bienvenue</h1>
        <small>Lycée Pierre Mendès France — maths.labomaths.tn</small>
      </div>
      <div>
        <a class="btn" href="#login">Connexion</a>
      </div>
    </header>

    <nav>
      <a href="#eds-premiere">EDS Première</a> |
      <a href="#eds-terminale">EDS Terminale</a> |
      <a href="#maths-expertes">Maths expertes</a> |
      <a href="docs/">Aperçu (docs)</a>
    </nav>

    <section class="card">
      <p>Choisissez une rubrique. Le sommaire est généré automatiquement depuis le contenu disponible.</p>
    </section>

    <section id="eds-premiere" class="card">
      <h2>EDS Première</h2>
      <ul id="eds_premiere-list"></ul>
    </section>

    <section id="eds-terminale" class="card">
      <h2>EDS Terminale</h2>
      <ul id="eds_terminale-list"></ul>
    </section>

    <section id="maths-expertes" class="card">
      <h2>Maths expertes</h2>
      <ul id="maths_expertes-list"></ul>
    </section>

    <section id="login" class="card">
      <h2>Connexion</h2>
      <p>À venir: connexion élève/enseignant (avec rôles et base d’élèves). Pour l’instant, cette section est un placeholder.</p>
    </section>

    <footer class="card">
      <small>© 2025 — Portail Maths. Tous droits réservés.</small>
    </footer>
  </div>

  <script>
    async function loadContents(){
      try{
        const res = await fetch('/api/contents',{credentials:'include'});
        const data = await res.json();
        renderList('eds_premiere', data.eds_premiere);
        renderList('eds_terminale', data.eds_terminale);
        renderList('maths_expertes', data.maths_expertes);
      }catch(e){console.error(e);}
    }
    function renderList(prefix, chapters){
      const root = document.getElementById(prefix+'-list');
      if(!root) return; root.innerHTML = '';
      (chapters||[]).forEach(ch=>{
        const li = document.createElement('li');
        const h3 = document.createElement('h3');
        h3.textContent = ch.chapter === '_racine' ? 'Racine' : ch.chapter;
        li.appendChild(h3);
        const ul = document.createElement('ul');
        (ch.pages||[]).forEach(p=>{
          const li2 = document.createElement('li');
          const a = document.createElement('a');
          a.href = p.url; a.textContent = p.title || p.url; a.style.color = '#7dd3fc';
          li2.appendChild(a); ul.appendChild(li2);
        });
        li.appendChild(ul); root.appendChild(li);
      });
      if(!root.childElementCount){ const li=document.createElement('li'); li.textContent='Aucun contenu disponible.'; root.appendChild(li); }
    }
    loadContents();
  </script>
</body>
</html>

